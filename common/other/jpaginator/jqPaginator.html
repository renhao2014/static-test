//目前还只写了约束分页查找，增删改待开发
<!doctype html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="Generator" content="EditPlus®">
		<title>信息</title>
		<link rel="stylesheet" href="fontsome/font-awesome.min.css" />
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/bacs.css" />
		<script type="text/javascript" src="../js/jquery/jquery-1.8.3.min.js"></script>
		<script type="text/javascript" src="../js/jqPaginator.min.js"></script>
		<script type="text/javascript" src="../js/selfJs/constant.js"></script>
	</head>

	<body>
		<div class="cont_box">
			<div class="bdu">
				<input type="text" id="mobile" name="" placeholder="手机号码">
				<input type="text" id="status" name="" placeholder="状态">
				<a href="javascript:void(0)" class="sou" onclick="query(this)">查询</a>
			</div>

			<div id="div1">
				<table cellpadding="0" cellspacing="0">
					<thead>
						<tr>
							<th>用户ID</th>
							<th>手机</th>
							<th>用户状态</th>
							<th>创建时间</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>

			</div>

			<!-- 跳转页码 -->
			<div class="tab_bottom">
				<!--<p>共<span></span>条记录&nbsp;&nbsp;每页显示10条</p>-->
				<input type="text" id="text" />
				<form id="form1" runat="server">
					<div>
					</div>
					<div>
						<ul class="pagination" id="pagination">
						</ul>
						<!-- 总页数 -->
						<input type="hidden" id="PageCount" runat="server" />
						<!-- 每页记录条数 -->
						<input type="hidden" id="PageSize" runat="server" value="10" />
						<input type="hidden" id="countindex" runat="server" value="10" />
						<!--设置最多显示的页码数 可以手动设置 默认为7-->
						<input type="hidden" id="visiblePages" runat="server" value="10" />
					</div>
				</form>
			</div>
		</div>
		<!-- 删除弹窗 -->
		<div class="pudxx_box" style="display: none">
			<div class="pudx">
				<p>确定删除该条信息吗？</p>
				<div class="Dete_box">
					<a href="javascript:void(0)" onclick="shortge(this)">确定</a>
					<a href="javascript:void(0)" onclick="puxx(this)">取消</a>
				</div>
			</div>
		</div>

		<script>
			// 数据展示
			var CONST_IP = "http://192.168.1.118/km_airhotel";
			// 时间戳转换
			function getDate(tm) {
				var tt = new Date(tm).toLocaleString();
				return tt;
			}

			//初始化jqPaginator
			function jqPaginatorReset() {
				$('#pagination').jqPaginator({
					totalPages: 100,
					visiblePages: 10,
					currentPage: 1,
					//分页插件翻页事件回调
					onPageChange: function(num, type) {
						$('#text').val('当前第' + num + '页');
						//获取当前约束值
						var restraint = getRestraint(num);
						console.log("翻页事件回调")
						getUsersDataToTable(restraint);
					}
				});
			}

			function query() {
				jqPaginatorReset();
			}

			//根据约束获取用户列表数据
			function getUsersDataToTable(restraint) {
				$.ajax({
					type: "post",
					url: CONST_IP + "/manage/user/findByExample",
					dateType: "jsonp",
					data: restraint,
					success: function(data) {
						dataToTable(data);
					}
				});
			}

			//根据数据 绘制表格
			function dataToTable(dataa) {
				var list = dataa.data;
				page = dataa.total;
				$(".tab_bottom p span").text(list.length);
				$(".cont_box table tbody").children().remove();
				for(var i = 0; i < list.length; i++) {
					$(".cont_box table tbody").append("<tr>" +
						"<td>" + list[i].userId + "</td>" +
						"<td>" + list[i].mobile + "</td>" +
						"<td>" + list[i].mobile + "</td>" +
						"<td>" + getDate(list[i].createTime) + "</td>" +
						"<td>" +
						"<div class='caozho width_34'>" +
						"<a href='javascript:void(0)' style='display: none;' onclick='modify(this)'></a>" +
						"<a href='javascript:void(0)' onclick='deletereom(this)'></a>" +
						"</div>" +
						"</td>" +
						"</tr>")
				}
			}

			function getRestraint(page) {
				var restraint = new Object;
				var mobile = $("#mobile").val();
				var status = $("#status").val();
				if(mobile != null && mobile != "") {
					restraint.mobile = mobile;
				}
				if(status != null && status != "") {
					restraint.statusId = status;
				}
				restraint.page = page - 1;
				restraint.pageSize = PAGE_SIZE;
				return restraint;
			}

			$(function() {
				jqPaginatorReset();
			});
		</script>
	</body>

</html>